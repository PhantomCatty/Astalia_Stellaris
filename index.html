<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Astalia Stellaris | Official Archive</title>
    <!-- 引入 Google Fonts 增加设计感 -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;700&family=Rajdhani:wght@500;700&display=swap" rel="stylesheet">
    <!-- 引入 jsmediatags 用于读取 MP3 元数据 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jsmediatags/3.9.5/jsmediatags.min.js"></script>
    <!-- 网站图标 favicon 设置 -->
    <link rel="icon" type="image/x-icon" href="./favicon.ico?v=2">
    <link rel="shortcut icon" href="./favicon.ico?v=2">
    <style>
        :root {
            /* --- 核心配色：可根据你的角色配色调整 --- */
            --primary-color: #7e46ff; /* 类似蔚蓝档案的清爽蓝 */
            --accent-color: #ff88bf;  /* 强调色：粉色 */
            --text-dark: #000000;
            --text-light: #fdff9a;
            
            /* --- 玻璃容器背景 --- */
            --glass-bg: rgba(255, 255, 255, 0.3); /* 主要是白色磨砂，更适合二次元 */
            --glass-border: rgba(255, 255, 255, 0.6);
            
            /* --- 内容区域背景图设置 --- */
            /* 你可以替换这里的图片来定制内容区域的背景 */
            /* 例如: --content-bg-image: url('assets/content_bg.jpg'); */
            /* 默认使用渐变色，你可以随时切换为图片 */
            --content-bg-image: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            
            /* --- 你的自定义背景图在这里设置 --- */
            /* 请把你的背景图命名为 bg.jpg 放在 assets 文件夹，或者直接替换下方 url */
            /* --user-bg-image: url('assets/bg.mp4'); (已启用视频背景，请查看下方 .bg-video 样式) */
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Rajdhani', 'Noto Sans SC', sans-serif;
            color: var(--text-dark);
            height: 100vh;
            overflow: hidden; /* 禁止整页滚动，内容在区域内滚动 */
            background-color: #eeeeee;
        }

        /* 1. 全局背景层 */
        .bg-video {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover;
            z-index: -2;
        }
        
        /* 半透明遮罩，防止背景太花干扰文字 */
        .bg-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.4), rgba(20, 100, 255, 0.1));
            backdrop-filter: blur(5px); /* 给背景一点模糊，更有高级感 */
            z-index: -1;
        }

        /* 2. 布局框架 */
        .app-container {
            display: flex;
            width: 100%;
            height: 100vh;
            padding: 0; /* 移除全局内边距，实现内容区竖向铺满 */
            padding-right: 40px; /* 右侧留白，平衡视觉 */
            gap: 40px; /* 增加侧边栏与内容区之间的间距 */
        }

        /* 3. 左侧侧边栏 (Sidebar) */
        .sidebar {
            width: 280px;
            /* 保持悬浮感，手动添加边距 */
            margin: 40px 0 40px 40px; 
            height: calc(100% - 80px);
            background: var(--glass-bg);
            border: 2px solid #fff;
            border-radius: 20px;
            padding: 40px 30px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            flex-shrink: 0;
            z-index: 20; /* 确保侧边栏在内容之上（如果重叠） */
        }

        .logo-area {
            margin-bottom: 50px;
        }
        .logo-area h1 {
            font-size: 1.8rem;
            line-height: 1.2;
            color: var(--primary-color);
            text-transform: uppercase;
            font-weight: 700;
        }
        .logo-area span { font-size: 0.9rem; color: #888; letter-spacing: 2px; }

        .nav-menu {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .nav-btn {
            padding: 15px 20px;
            border-radius: 12px;
            border: none;
            background: transparent;
            text-align: left;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--text-dark);
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            font-family: 'Rajdhani', sans-serif; /* 英文用科技字体 */
        }

        /* 选中/悬停状态 */
        .nav-btn:hover, .nav-btn.active {
            background: white;
            color: var(--primary-color);
            box-shadow: 0 5px 15px rgba(93, 156, 236, 0.2);
            padding-left: 30px; /* 动效：向右移动 */
        }
        
        /* 选中时左侧的小条 */
        .nav-btn.active::before {
            content: '';
            position: absolute;
            left: 10px; top: 50%; transform: translateY(-50%);
            width: 4px; height: 16px;
            background: var(--primary-color);
            border-radius: 2px;
        }

        /* 底部信息 */
        .sidebar-footer {
            margin-top: auto;
            font-size: 0.8rem;
            color: #aaa;
        }

        /* 4. 右侧内容区 (Main Content) */
        .content-window {
            flex-grow: 1;
            position: relative;
            overflow: hidden;
            /* 恢复容器白底和边框 (不裁剪) */
            background: rgba(255, 255, 255, 0.3); /* 白底，确保内容清晰 */
            /* border: 2px solid #fff; */
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        /* 内容背景层 - 梯形裁切 */
        .content-bg-layer {
            position: absolute;
            top: -150px;
            left: 0px;
            width: 100%;
            height: 100%;
            z-index: 1;
            overflow: hidden;
        }

        /* 梯形遮罩容器 (合并了背景图和渐变遮罩) */
        .trapezoid-mask {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* 梯形裁切路径 - 左侧倾斜 */
            clip-path: polygon(8% 15%, 100% 15%, 100% 75%, 0% 75%);
            
            /* 拆分背景属性以确保兼容性和优先级 */
            background-color: transparent;
            background-image: var(--content-bg-image, linear-gradient(135deg, #667eea 0%, #764ba2 100%));
            background-repeat: no-repeat;
            background-position: center center;
            /* 强制拉伸背景图至容器的 100% 宽和 100% 高 */
            background-size: 100% 100% !important;
            
            opacity: 1; /* 提高不透明度，让背景图清晰可见 */
            transition: background-image 0.5s ease; /* 添加背景切换过渡动画 */
        }

        /* 使用伪元素实现渐变和模糊效果 */
        .trapezoid-mask::after {
            content: '';
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            /* 增强渐变对比度，从较不透明的白色过渡到完全透明 */
            background: linear-gradient(to bottom, 
                rgba(255,255,255,0.5) 0%, 
                rgba(255,255,255,0.3) 40%, 
                rgba(255,255,255,0.0) 100%);
            /* backdrop-filter: blur(3px); 轻微模糊背景图 */
            pointer-events: none;
        }

        /* 装饰边框 - 跟随梯形 */
        .content-border {
            position: absolute;
            top: 20px;
            left: 20px;
            right: 20px;
            bottom: 20px;
            clip-path: polygon(8% 0%, 100% 0%, 100% 100%, 0% 100%);
            border: 2px solid rgba(126, 70, 255, 0.3);
            pointer-events: none;
            z-index: 3;
        }

        /* 页面切换动画容器 */
        .page-section {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            padding: 50px 60px 50px 80px; /* 左侧留更多空间适应梯形 */
            opacity: 0;
            transform: translateX(30px);
            transition: all 0.6s cubic-bezier(0.25, 1, 0.5, 1);
            pointer-events: none;
            overflow-y: auto;
            overflow-x: hidden;
            z-index: 5; /* 确保在所有背景层之上 */
        }

        .page-section.active {
            opacity: 1;
            transform: translateX(0);
            pointer-events: auto;
            z-index: 10;
        }

        /* 自定义滚动条 */
        .page-section::-webkit-scrollbar {
            width: 8px;
        }
        .page-section::-webkit-scrollbar-track {
            background: rgba(0,0,0,0.05);
            border-radius: 10px;
        }
        .page-section::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 10px;
        }
        .page-section::-webkit-scrollbar-thumb:hover {
            background: var(--accent-color);
        }

        /* ---------------- 各个页面的特定样式 ---------------- */

        /* 首页：大立绘展示 */
        #home-page {
            display: flex;
            align-items: center;
            justify-content: space-between;
            overflow: hidden; /* 首页不滚动 */
        }
        .home-text {
            max-width: 45%;
            z-index: 2;
        }
        .home-text h2 { font-size: 3.5rem; color: var(--primary-color); margin-bottom: 20px; line-height: 1; }
        .home-text p { font-size: 1.2rem; color: #555; margin-bottom: 30px; line-height: 1.6; }
        
        .tachie-container {
            position: absolute;
            right: -5%; top: 5%; bottom: -5%;
            width: 60%;
            background: url('assets/char_tachie.png') no-repeat center bottom;
            background-size: contain;
            /* 如果没有图片，用这个占位符显示效果 */
            /* background-color: rgba(93, 156, 236, 0.1); */
            z-index: 5;
            filter: drop-shadow(-10px 0 20px rgba(0,0,0,0.1));
            /* 呼吸动效 */
            /* animation: breathe 4s ease-in-out infinite; */
        }
        .sprite-variations-container1 {
            position: absolute;
            right: 35%; top: 5%; bottom: 70%;
            width: 10%;
            background: url('assets/sprite_variations1.png') no-repeat center bottom;
            background-size: contain;
            /* 如果没有图片，用这个占位符显示效果 */
            /* background-color: rgba(93, 156, 236, 0.1); */
            z-index: 1;
            filter: drop-shadow(-10px 0 20px rgba(0,0,0,0.1));
            /* 呼吸动效 */
            /* animation: breathe 4s ease-in-out infinite; */
        }
        .sprite-variations-container2 {
            position: absolute;
            right: 35%; top: 5%; bottom: 52%;
            width: 10%;
            background: url('assets/sprite_variations2.png') no-repeat center bottom;
            background-size: contain;
            /* 如果没有图片，用这个占位符显示效果 */
            /* background-color: rgba(93, 156, 236, 0.1); */
            z-index: 1;
            filter: drop-shadow(-10px 0 20px rgba(0,0,0,0.1));
            /* 呼吸动效 */
            /* animation: breathe 4s ease-in-out infinite; */
        }
        .sprite-variations-container3 {
            position: absolute;
            right: 35%; top: 5%; bottom: 34%;
            width: 10%;
            background: url('assets/sprite_variations3.png') no-repeat center bottom;
            background-size: contain;
            /* 如果没有图片，用这个占位符显示效果 */
            /* background-color: rgba(93, 156, 236, 0.1); */
            z-index: 1;
            filter: drop-shadow(-10px 0 20px rgba(0,0,0,0.1));
            /* 呼吸动效 */
            /* animation: breathe 4s ease-in-out infinite; */
        }

        /* 装饰圆环 */
        .decor-circle {
            position: absolute;
            right: 10%; bottom: 10%;
            width: 500px; height: 500px;
            border: 2px dashed rgba(93, 156, 236, 0.3);
            border-radius: 50%;
            animation: spin 30s linear infinite;
            z-index: 0;
        }

        /* 内页通用排版 */
        .page-header {
            border-bottom: 2px solid rgba(0,0,0,0.05);
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        .page-header h2 { font-size: 2.5rem; color: var(--text-dark); }
        .page-header span { color: var(--accent-color); font-weight: bold; letter-spacing: 2px; }

        .content-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
        }

        /* 资产卡片 */
        .asset-card {
            background: #fff;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            transition: transform 0.3s ease;
            cursor: pointer;
        }
        .asset-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(93, 156, 236, 0.2); }
        .card-media {
            height: 200px;
            background-color: #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #888;
        }
        .card-media img, .card-media video { width: 100%; height: 100%; object-fit: cover; }
        .card-info { padding: 20px; }
        .card-info h3 { font-size: 1.2rem; margin-bottom: 8px; color: var(--text-dark); }
        .card-info p { font-size: 0.9rem; color: #888; }

        /* --- 新增模块化布局样式 --- */
        .content-module {
            display: flex;
            gap: 40px;
            margin-bottom: 60px; /* 模块间距 */
            align-items: flex-start;
        }

        .module-header {
            flex: 0 0 240px; /* 左侧固定宽度 */
            position: sticky;
            top: 20px;
        }

        .module-header h3 {
            font-size: 1.4rem;
            color: var(--primary-color);
            margin-bottom: 15px;
            border-left: 4px solid var(--accent-color);
            padding-left: 12px;
            line-height: 1.3;
        }

        .module-header p {
            font-size: 0.95rem;
            color: #666;
            line-height: 1.6;
            text-align: justify;
        }

        .module-content {
            flex: 1;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
        }

        /* 动画定义 */
        @keyframes breathe { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.02); } }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* 移动端适配 */
        @media (max-width: 900px) {
            .app-container { flex-direction: column; padding: 0; height: auto; }
            .sidebar { width: 100%; height: auto; border-radius: 0; padding: 20px; }
            .nav-menu { flex-direction: row; overflow-x: auto; }
            .content-window { height: 80vh; }
            .trapezoid-mask { clip-path: none; } /* 移动端取消梯形裁切 */
            .content-border { clip-path: none; border: none; }
            .page-section { padding: 30px 20px; }
            .tachie-container { opacity: 0.2; right: -20%; }
            
            /* 模块化布局移动端适配 */
            .content-module { flex-direction: column; gap: 20px; margin-bottom: 40px; }
            .module-header { width: 100%; flex: none; margin-bottom: 10px; position: static; }
            
            /* 音乐播放器移动端适配 */
            .player-layout { flex-direction: column !important; }
            .player-left { margin-bottom: 20px; width: 100%; }
        }

        /* --- 音乐播放器模块样式 --- */
        .player-layout {
            display: flex;
            flex-direction: row;
            gap: 30px;
            background: rgba(255, 255, 255, 0.5);
            padding: 30px;
            border-radius: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            border: 1px solid rgba(255,255,255,0.6);
        }

        .player-left {
            flex: 0 0 240px;
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

        .vinyl-wrapper {
            position: relative;
            width: 200px;
            height: 200px;
            margin-bottom: 25px;
            flex-shrink: 0;
        }

        /* 黑胶唱片本体 */
        .vinyl-disc {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            /* 模拟黑胶纹理 */
            background: repeating-radial-gradient(
              #181818,
              #181818 2px,
              #282828 3px,
              #282828 4px
            );
            box-shadow: 0 10px 25px rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            animation: spin 6s linear infinite;
            animation-play-state: paused; /* 默认暂停 */
            border: 4px solid #000;
        }

        .vinyl-disc.playing {
            animation-play-state: running;
        }

        /* 唱片封面 (圆形裁切) */
        .vinyl-cover {
            width: 45%;
            height: 45%;
            border-radius: 50%;
            background-size: cover;
            background-position: center;
            border: 3px solid #fff;
            background-color: #ddd;
            position: relative;
        }
        /* 唱片中心孔 */
        .vinyl-cover::after {
            content: '';
            position: absolute;
            top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 12px; height: 12px;
            background: #000;
            border-radius: 50%;
        }

        /* 播放按钮 (悬浮在唱片中心) */
        .play-control-btn {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 46px; height: 46px;
            border-radius: 50%;
            background: var(--primary-color);
            color: white;
            border: 2px solid #fff;
            font-size: 1.2rem;
            cursor: pointer;
            opacity: 0.9;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            box-shadow: 0 5px 15px rgba(126, 70, 255, 0.4);
        }
        .play-control-btn:hover { opacity: 1; transform: translate(-50%, -50%) scale(1.1); }

        .current-song-info { width: 100%; }
        .current-song-info h4 {
            color: var(--primary-color);
            margin-bottom: 5px;
            font-size: 1.2rem;
            font-family: 'Rajdhani', sans-serif;
            font-weight: 700;
        }
        .current-song-info span {
            display: block;
            font-size: 0.9rem;
            color: #555;
            margin-bottom: 2px;
        }
        .album-tag {
            font-size: 0.8rem !important;
            color: var(--accent-color) !important;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 8px !important;
        }

        .player-right {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 20px;
            overflow: hidden;
        }

        .playlist {
            flex: 1;
            overflow-y: auto;
            max-height: 220px;
            padding-right: 10px;
            background: rgba(255,255,255,0.3);
            border-radius: 10px;
            padding: 10px;
        }

        .playlist-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-bottom: 1px solid rgba(0,0,0,0.05);
            cursor: pointer;
            transition: all 0.2s;
            border-radius: 8px;
            font-size: 0.95rem;
            margin-bottom: 5px;
        }
        .playlist-item:hover {
            background: rgba(255,255,255,0.8);
            padding-left: 20px;
        }
        .playlist-item.active {
            background: var(--primary-color);
            color: white;
            box-shadow: 0 4px 10px rgba(126, 70, 255, 0.3);
        }
        .playlist-item.active span { color: white; }
        
        /* 正在播放的动画图标 */
        .playing-icon {
            display: none;
            font-size: 0.8rem;
        }
        .playlist-item.active .playing-icon { display: block; }

        .song-description-box {
            background: rgba(255,255,255,0.6);
            padding: 15px 20px;
            border-radius: 10px;
            font-size: 0.9rem;
            color: #555;
            border-left: 4px solid var(--accent-color);
            line-height: 1.6;
        }
        .song-description-box h5 {
            margin-bottom: 5px;
            color: var(--text-dark);
            font-size: 0.85rem;
            opacity: 0.7;
            text-transform: uppercase;
        }

        /* 滚动条美化 */
        .playlist::-webkit-scrollbar { width: 6px; }
        .playlist::-webkit-scrollbar-track { background: rgba(0,0,0,0.05); border-radius: 3px; }
        .playlist::-webkit-scrollbar-thumb { background: #ccc; border-radius: 3px; }
        .playlist::-webkit-scrollbar-thumb:hover { background: var(--primary-color); }
    </style>
</head>
<body>

    <!-- 1. 背景层 -->
    <video class="bg-video" autoplay loop muted playsinline>
        <source src="assets/bg.mp4" type="video/mp4">
    </video>
    <div class="bg-overlay"></div>

    <div class="app-container">
        
        <!-- 2. 左侧导航栏 -->
        <nav class="sidebar">
            <div class="logo-area">
                <h1>Astalia<br>Stellaris</h1>
                <span>PROJECT ARCHIVE</span>
            </div>
            
            <div class="nav-menu">
                <!-- onclick 切换页面的核心逻辑 -->
                <!-- data-bg 属性用于配置该栏目的背景图，可使用 url('...') 或 渐变色 -->
                <button class="nav-btn active" 
                        onclick="switchPage('home-page', this)"
                        data-bg="url('assets/bg_home.png')">
                    00_首页 / HOME
                </button>
                <button class="nav-btn" 
                        onclick="switchPage('origin-page', this)"
                        data-bg="url('assets/bg_origin.png')">
                    01_起源 / ORIGIN
                </button>
                <button class="nav-btn" 
                        onclick="switchPage('avatar-page', this)"
                        data-bg="url('assets/bg_avatar.png')">
                    02_化身 / AVATAR
                </button>
                <button class="nav-btn" 
                        onclick="switchPage('tech-page', this)"
                        data-bg="url('assets/bg_tech.png')">
                    03_技术 / TECH
                </button>
                <button class="nav-btn" 
                        onclick="switchPage('world-page', this)"
                        data-bg="url('assets/bg_world.png')">
                    04_世界 / WORLD
                </button>
            </div>

            <div class="sidebar-footer">
                <p>Powered by [Zhenming Duan]</p>
            </div>
        </nav>

        <!-- 3. 右侧内容窗口 -->
        <main class="content-window">
            <!-- 背景层结构 -->
            <div class="content-bg-layer">
                <div class="trapezoid-mask"></div>
            </div>
            <div class="content-border"></div>
            
            <!-- A. 首页 (HOME) -->
            <section id="home-page" class="page-section active">
                <div class="decor-circle"></div>
                
                <div class="home-text">
                    <h2>VIRTUAL<br>IDENTITY</h2>
                    <p>“并不是所有人都有能力得到爱，但人人都有资格拥有爱。”</p>
                    <p style="font-size: 0.9rem; color:#888;">
                        一个始于社区危机的虚拟救赎实验。<br>
                        融合实时变声、Live2D表演与3D交互的跨媒介叙事。<br>
                        Produced by Zhenming Duan
                    </p>
                    <button onclick="window.open('assets/Design_document.pdf', '_blank')" style="padding: 12px 30px; background: var(--primary-color); color: white; border:none; border-radius: 25px; cursor: pointer; font-weight: bold;">
                        View Design Statement
                    </button>
                </div>

                <!-- 你的角色立绘 (请替换图片 assets/char_tachie.png) -->
                <div class="tachie-container"></div>
                
                <!-- 差分立绘展示 -->
                <div class="sprite-variations-container1"></div>
                <div class="sprite-variations-container2"></div>
                <div class="sprite-variations-container3"></div>
            </section>

            <!-- B. 起源 (ORIGIN) -->
            <section id="origin-page" class="page-section">
                <div class="page-header">
                    <span>CHAPTER 01</span>
                    <h2>起源与概念 / Origin</h2>
                </div>
                
                <div class="content-module">
                    <div class="module-header">
                        <h3>项目背景</h3>
                        <p>项目起源于2024年4月的一场社区情感危机。基于对玩家群体“情感代偿”机制的民族志观察，我构思了这个角色。</p>
                    </div>
                    <div class="module-content">
                        <div class="asset-card">
                            <div class="card-media">
                                <!-- 示例图片 -->
                                <img src="assets/origin_01.jpg" alt="Crisis Analysis">
                            </div>
                            <div class="card-info">
                                <h3>社区事件分析</h3>
                                <p>舆论危机的时间线整理与情绪分析图表。</p>
                            </div>
                        </div>
                        <div class="asset-card">
                            <div class="card-media">
                                <img src="assets/origin_02.jpg" alt="Concept Draft">
                            </div>
                            <div class="card-info">
                                <h3>早期概念草图</h3>
                                <p>基于“星塔”意象的角色原型设计。</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- C. 化身 (AVATAR) -->
            <section id="avatar-page" class="page-section">
                <div class="page-header">
                    <span>CHAPTER 02</span>
                    <h2>数字肉身 / Avatar</h2>
                </div>
                
                <div class="content-module">
                    <div class="module-header">
                        <h3>角色展示</h3>
                        <p>包含角色视觉外观、情感差分立绘以及背景信息的宣传视频。</p>
                    </div>
                    <div class="module-content">
                        <div class="asset-card" style="grid-column: 1 / -1;">
                            <div class="card-media" style="height: 400px;">
                                <!-- 视频位 -->
                                <video src="assets/PV.mp4" controls></video>
                                <!-- <div style="text-align:center;">直播切片演示视频 (Project Reel)</div> -->
                            </div>
                            <div class="card-info">
                                <h3>Character Showcase</h3>
                                <p>A promotional video featuring the character’s visual appearance, emotional sprite variations, and background information.<br>
                                    - Illustrator: 怠DiE(DaiDie)<br>
                                    - Modeler: 小路姬_Ibuki<br>
                                    - Video Production: Astalia_Stellaris(Zhenming Duan)<br>
                                    - BGM: A Guiding Star by Elliot Hsu
                                </p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="content-module">
                    <div class="module-header">
                        <h3>实时演出</h3>
                        <p>展示 RVC 实时变声效果的直播切片演示。</p>
                    </div>
                    <div class="module-content">
                        <div class="asset-card" style="grid-column: 1 / -1;">
                            <div class="card-media" style="height: 400px;">
                                <!-- 视频位 -->
                                <iframe src="https://www.youtube.com/watch?v=UsMDVWR4Edk" frameborder="0"></iframe>
                                <!-- <div style="text-align:center;">直播切片演示视频 (Project Reel)</div> -->
                            </div>
                            <div class="card-info">
                                <h3>Live Performance Reel</h3>
                                <p>A showcase of RVC real-time voice changing effects.<br>
                                    -Original Song: Toki wa Itoshiki Mono o Nosete ~Forget You Not~<br>
                                    -Original Singer: Madoka Yonezawa
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- D. 技术 (TECH) -->
            <section id="tech-page" class="page-section">
                <div class="page-header">
                    <span>CHAPTER 03</span>
                    <h2>技术演进 / Tech Stack</h2>
                </div>
                
                <div class="content-module">
                    <div class="module-header">
                        <h3>技术栈概览</h3>
                        <p>从 ComfyUI 辅助设计到 Blender 3D 建模，再到 Unity 实时渲染的全流程技术探索。</p>
                    </div>
                    <div class="module-content">
                        <div class="asset-card">
                            <div class="card-media">
                                <img src="assets/tech_blender.jpg" alt="Blender Wireframe">
                            </div>
                            <div class="card-info">
                                <h3>3D 拓扑结构</h3>
                                <p>自学 Blender 完成的头部布线优化，适应二次元渲染。</p>
                            </div>
                        </div>
                        <div class="asset-card">
                            <div class="card-media">
                                <img src="assets/tech_unity.jpg" alt="Unity Scene">
                            </div>
                            <div class="card-info">
                                <h3>Unity NPR 渲染</h3>
                                <p>使用 LilToon 着色器实现的仿手绘质感。</p>
                            </div>
                        </div>
                        <div class="asset-card">
                            <div class="card-media">
                                <img src="assets/tech_ai.jpg" alt="ComfyUI Workflow">
                            </div>
                            <div class="card-info">
                                <h3>AI 辅助工作流</h3>
                                <p>基于 SDXL 的 LoRA 训练与 ComfyUI 节点图。</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- E. 世界 (WORLD) -->
            <section id="world-page" class="page-section">
                <div class="page-header">
                    <span>CHAPTER 04</span>
                    <h2>世界观 / World Building</h2>
                </div>
                
                <div class="content-module">
                    <div class="module-header">
                        <h3>世界架构</h3>
                        <p>构建中的叙事宇宙，包含势力分布与核心地标设定。</p>
                    </div>
                    <div class="module-content">
                        <div class="asset-card" style="grid-column: 1 / -1;">
                            <div class="card-media">
                                <img src="assets/world_map.jpg" alt="Lore Map">
                            </div>
                            <div class="card-info">
                                <h3>星塔世界全图</h3>
                                <p>未完成的叙事宇宙架构与势力分布。</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 新增：音乐播放器模块 -->
                <div class="content-module" id="music-module">
                    <div class="module-header">
                        <h3>原声音乐 / OST</h3>
                        <p>收录企划相关的原创音乐与印象曲目。<br>点击右侧列表切换歌曲。</p>
                    </div>
                    <div class="module-content player-layout">
                        <!-- 左侧：黑胶唱片与信息 -->
                        <div class="player-left">
                            <div class="vinyl-wrapper">
                                <div class="vinyl-disc" id="vinylDisc">
                                    <div class="vinyl-cover" id="vinylCover"></div>
                                </div>
                                <button class="play-control-btn" id="playPauseBtn" onclick="togglePlay()">
                                    ▶
                                </button>
                            </div>
                            <div class="current-song-info">
                                <h4 id="currentTitle">Song Title</h4>
                                <span id="currentArtist">Artist Name</span>
                                <span id="currentAlbum" class="album-tag">ALBUM NAME</span>
                            </div>
                        </div>

                        <!-- 右侧：歌单与描述 -->
                        <div class="player-right">
                            <div class="playlist" id="playlist">
                                <!-- JS 生成列表项 -->
                            </div>
                            <div class="song-description-box">
                                <h5>Track Description</h5>
                                <p id="currentDesc">正在加载歌曲信息...</p>
                            </div>
                        </div>
                        
                        <!-- 隐藏的音频元素 -->
                        <audio id="audioPlayer" onended="playNext()"></audio>
                    </div>
                </div>
            </section>

        </main>
    </div>

    <script>
        // 页面切换逻辑
        function switchPage(pageId, btnElement) {
            // 1. 隐藏所有页面
            const pages = document.querySelectorAll('.page-section');
            pages.forEach(page => {
                page.classList.remove('active');
            });

            // 2. 显示目标页面
            const targetPage = document.getElementById(pageId);
            if(targetPage) {
                targetPage.classList.add('active');
            }

            // 3. 更新按钮状态
            const buttons = document.querySelectorAll('.nav-btn');
            buttons.forEach(btn => {
                btn.classList.remove('active');
            });
            btnElement.classList.add('active');

            // 4. 更新背景图
            // 获取按钮上的 data-bg 属性
            const newBg = btnElement.getAttribute('data-bg');
            if (newBg) {
                // 设置 CSS 变量，驱动 .trapezoid-mask 的背景变化
                document.documentElement.style.setProperty('--content-bg-image', newBg);
            }
        }

        // 初始化：页面加载时应用默认激活按钮的背景
        document.addEventListener('DOMContentLoaded', () => {
            const activeBtn = document.querySelector('.nav-btn.active');
            if(activeBtn) {
                const bg = activeBtn.getAttribute('data-bg');
                if(bg) {
                    document.documentElement.style.setProperty('--content-bg-image', bg);
                }
            }
            // 初始化播放器
            initPlayer();
        });

        // --- 音乐播放器逻辑 ---
        // 请在这里配置你的音乐文件路径
        // 注意：为了读取 MP3 元数据，请使用 Live Server 运行或部署到服务器，直接双击打开 HTML 可能因浏览器安全策略无法读取。
        const musicData = [
            {
                src: "assets/music/Starborn_of_Luciarion.mp3",   
                desc: "Starborn of Luciarion - 表现星之子诞生的辉煌时刻，节奏激昂。"
            },
            {
                src: "assets/music/The_Second_Starnucleus_Tower.mp3",
                desc: "The Second Starnucleus Tower - 宏伟的建筑与古老的科技感交织。"
            },
            {
                src: "assets/music/Astheral.mp3",
                desc: "Astheral - 象征星塔诞生的主题曲。旋律宏大而悠远，使用了管弦乐与合成器的混合编制。"
            },
            {
                src: "assets/music/Nyxarion.mp3",
                desc: "Nyxarion - 深邃夜空下的低语，静谧而略带忧伤。"
            },
            {
                src: "assets/music/Iridis_Medusae_Vinum.mp3",
                desc: "Iridis Medusae Vinum - 充满了神秘色彩的旋律，仿佛置身于幻彩的星云之中。"
            },
            {
                src: "assets/music/Zephyr_Leviathan.mp3",
                desc: "Zephyr Leviathan - 如同巨兽在云海中穿梭，气势磅礴。"
            }
        ];

        let currentTrackIndex = 0;
        const audioPlayer = document.getElementById('audioPlayer');
        const vinylDisc = document.getElementById('vinylDisc');
        const playBtn = document.getElementById('playPauseBtn');
        
        // 缓存已读取的元数据，避免重复读取
        const metadataCache = new Map();

        function initPlayer() {
            // 先渲染一个初始列表（显示文件名或加载中）
            renderPlaylist();
            // 尝试加载第一首歌
            loadTrack(0);
            // 异步加载所有歌曲的元数据并刷新列表
            loadAllMetadata();
        }

        function loadAllMetadata() {
            musicData.forEach((track, index) => {
                // 确保 URL 是绝对路径，避免 jsmediatags 在某些环境下解析相对路径出错
                const absoluteUrl = new URL(track.src, window.location.href).href;

                fetchMetadata(absoluteUrl, (data) => {
                    // 将读取到的数据存入 track 对象
                    musicData[index] = { ...musicData[index], ...data };
                    // 刷新列表显示
                    updatePlaylistItem(index);
                    // 如果当前正在播放这首歌，更新播放器界面
                    if (index === currentTrackIndex) {
                        updatePlayerUI(index);
                    }
                });
            });
        }

        function fetchMetadata(url, callback) {
            if (metadataCache.has(url)) {
                callback(metadataCache.get(url));
                return;
            }

            // 使用 jsmediatags 读取
            window.jsmediatags.read(url, {
                onSuccess: function(tag) {
                    const tags = tag.tags;
                    let coverUrl = "";
                    
                    // 处理封面图片
                    if (tags.picture) {
                        const { data, format } = tags.picture;
                        let base64String = "";
                        for (let i = 0; i < data.length; i++) {
                            base64String += String.fromCharCode(data[i]);
                        }
                        coverUrl = `data:${format};base64,${window.btoa(base64String)}`;
                    }

                    const metadata = {
                        title: tags.title || url.split('/').pop(), // 没标题就用文件名
                        artist: tags.artist || "Unknown Artist",
                        album: tags.album || "Unknown Album",
                        cover: coverUrl
                    };
                    
                    metadataCache.set(url, metadata);
                    callback(metadata);
                },
                onError: function(error) {
                    console.warn("读取元数据失败 (可能是跨域或文件不存在):", url, error);
                    // 失败时的默认值
                    const fallback = {
                        title: url.split('/').pop(),
                        artist: "Unknown Artist",
                        album: "Unknown Album",
                        cover: "" 
                    };
                    callback(fallback);
                }
            });
        }

        function renderPlaylist() {
            const list = document.getElementById('playlist');
            if(!list) return;
            list.innerHTML = '';
            musicData.forEach((track, index) => {
                const item = document.createElement('div');
                item.id = `playlist-item-${index}`;
                item.className = `playlist-item ${index === currentTrackIndex ? 'active' : ''}`;
                item.onclick = () => playTrack(index);
                // 初始状态，可能还没有元数据
                const displayTitle = track.title || "Loading...";
                const displayArtist = track.artist || "...";
                
                item.innerHTML = `
                    <div style="display:flex; align-items:center; gap:10px;">
                        <span style="font-weight:bold; width:20px;">${index + 1}</span>
                        <div style="display:flex; flex-direction:column;">
                            <span class="item-title" style="font-weight:600;">${displayTitle}</span>
                            <span class="item-artist" style="font-size:0.8rem; opacity:0.7;">${displayArtist}</span>
                        </div>
                    </div>
                    <span class="playing-icon">♫</span>
                `;
                list.appendChild(item);
            });
        }

        function updatePlaylistItem(index) {
            const item = document.getElementById(`playlist-item-${index}`);
            if (item && musicData[index].title) {
                item.querySelector('.item-title').innerText = musicData[index].title;
                item.querySelector('.item-artist').innerText = musicData[index].artist;
            }
        }

        function loadTrack(index) {
            currentTrackIndex = index;
            const track = musicData[index];
            
            // 如果元数据还没加载完，先显示默认信息，等 loadAllMetadata 回调来更新
            updatePlayerUI(index);

            audioPlayer.src = track.src;
            
            // 更新列表选中状态
            const items = document.querySelectorAll('.playlist-item');
            items.forEach((item, i) => {
                if(i === index) item.classList.add('active');
                else item.classList.remove('active');
            });
        }

        function updatePlayerUI(index) {
            const track = musicData[index];
            const titleEl = document.getElementById('currentTitle');
            const artistEl = document.getElementById('currentArtist');
            const albumEl = document.getElementById('currentAlbum');
            const descEl = document.getElementById('currentDesc');
            const coverDiv = document.getElementById('vinylCover');

            if (track.title) {
                titleEl.innerText = track.title;
                artistEl.innerText = track.artist;
                albumEl.innerText = track.album;
                
                if(track.cover && track.cover !== "") {
                     coverDiv.style.backgroundImage = `url('${track.cover}')`;
                } else {
                     // 默认封面颜色或图片
                     coverDiv.style.backgroundImage = 'none';
                     coverDiv.style.backgroundColor = '#7e46ff';
                }
            } else {
                // 还在加载中
                titleEl.innerText = "Loading Metadata...";
                artistEl.innerText = "Please wait";
                albumEl.innerText = "";
            }
            
            // 描述是手动配置的，总是存在
            descEl.innerText = track.desc || "暂无介绍";
        }

        function playTrack(index) {
            if(index !== currentTrackIndex) {
                loadTrack(index);
            }
            togglePlay(true);
        }

        function togglePlay(forcePlay = false) {
            if (audioPlayer.paused || forcePlay) {
                audioPlayer.play().catch(e => console.log("Audio play failed (interaction needed):", e));
                vinylDisc.classList.add('playing');
                playBtn.innerText = "||"; // 暂停符号
            } else {
                audioPlayer.pause();
                vinylDisc.classList.remove('playing');
                playBtn.innerText = "▶"; // 播放符号
            }
        }
        
        function playNext() {
            let nextIndex = (currentTrackIndex + 1) % musicData.length;
            playTrack(nextIndex);
        }
    </script>
</body>
</html>